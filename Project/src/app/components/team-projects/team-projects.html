<div class="container">
  <header class="page-header">
    <div class="header-flex">
      <mat-icon class="header-icon">folder_special</mat-icon>
      <h1>פרויקטים של הצוות</h1>
    </div>
    <p class="team-id-text">מזהה צוות: {{ id() }}</p>
  </header>

  <div class="content-grid">
    <mat-card class="form-card mat-elevation-z3">
      <mat-card-header>
        <mat-card-title>פרויקט חדש</mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <form [formGroup]="projectForm" (ngSubmit)="onSubmit()" class="project-form">
          <mat-form-field appearance="fill" class="form-field-modern">
            <mat-label>שם הפרויקט</mat-label>
            <input matInput 
                   formControlName="name" 
                   placeholder="לדוגמה: אפליקציית ניהול משימות"
                   aria-label="שם הפרויקט">
            <mat-icon matPrefix>assignment</mat-icon>
            @if (projectForm.controls.name.invalid && projectForm.controls.name.touched) {
              <mat-error>שם הוא שדה חובה</mat-error>
            }
          </mat-form-field>

          <mat-form-field appearance="fill" class="form-field-modern">
            <mat-label>תיאור הפרויקט</mat-label>
            <textarea matInput 
                      formControlName="description" 
                      placeholder="תאר את מטרות הפרויקט ויעדיו"
                      matTextareaAutosize
                      minRows="4"
                      aria-label="תיאור הפרויקט"></textarea>
            <mat-icon matPrefix>description</mat-icon>
            @if (projectForm.controls.description.invalid && projectForm.controls.description.touched) {
              <mat-error>תיאור הוא שדה חובה</mat-error>
            }
          </mat-form-field>

          <button mat-raised-button 
                  color="primary" 
                  type="submit" 
                  [disabled]="projectForm.invalid || isLoading()"
                  class="submit-btn"
                  aria-label="הוסף פרויקט חדש">
            @if (!isLoading()) {
              <mat-icon>add_circle_outline</mat-icon>
              <span>הוסף פרויקט</span>
            } @else {
              <mat-spinner diameter="20"></mat-spinner>
              <span>יוצר...</span>
            }
          </button>
        </form>
      </mat-card-content>
    </mat-card>

    <div class="projects-list">
      <h2 class="section-title">פרויקטים קיימים</h2>
      
      @if (isLoading()) {
        <div class="loading-container">
          <mat-spinner diameter="40"></mat-spinner>
        </div>
      }
      
      @for(project of projects$ | async; track project.id) {
        @if (project.team_id == +id()) {
        <mat-card class="project-item mat-elevation-z1">
  <mat-card-content>
    <div class="project-info">
      <mat-icon color="accent" class="project-icon">assignment</mat-icon>
      
      <div class="text-content">
        <h3>{{ project.name }}</h3>
        <p>{{ project.description }}</p>
      </div>
      
      <span class="spacer"></span>

      <button mat-stroked-button 
              color="primary" 
              (click)="goToTasks(project.id)" 
              class="tasks-btn"
              [attr.aria-label]="'צפה במשימות של ' + project.name">
        <mat-icon>list_alt</mat-icon>
        <span>משימות</span>
      </button>
    </div>
  </mat-card-content>
</mat-card>
        }
      } @empty {
        <div class="empty-state">
          <mat-icon>inventory_2</mat-icon>
          <p>אין פרויקטים להצגה עבור צוות זה</p>
        </div>
      }
    </div>
  </div>
</div>